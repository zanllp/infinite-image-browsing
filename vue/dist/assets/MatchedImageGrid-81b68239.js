import{d as ke,r as he,s as C,aH as G,p as ve,o as u,j as S,c as n,y as e,x as o,B as z,k as d,C as Ie,t as a,l as p,v as U,O as we,aB as _e,m as b,Q as N,Y as Ce,V as Se,a2 as be,$ as E,a4 as ye,at as xe,au as Me,aI as Ae,n as Te}from"./index-840caa07.js";import{L as Ve,R as $e,f as De,M as Fe}from"./MultiSelectKeep-002ccaa9.js";import{s as Be,F as Re}from"./FileItem-f1712134.js";import{c as Ge,u as ze}from"./hook-585b5d04.js";import{g as Ue,o as J}from"./index-e670b2ef.js";/* empty css              */import"./index-77c608f4.js";import"./shortcut-38b7c0ce.js";import"./_isIterateeCall-70a3012d.js";const Ne=c=>(xe("data-v-6e837a6f"),c=c(),Me(),c),Ee={class:"hint"},Je={class:"action-bar"},Le=Ne(()=>d("div",{style:{padding:"16px 0 512px"}},null,-1)),Oe={key:1},Pe={class:"no-res-hint"},Ke={class:"hint"},We={key:2,class:"preview-switch"},qe=ke({__name:"MatchedImageGrid",props:{tabIdx:{},paneIdx:{},selectedTagIds:{},id:{}},setup(c){const k=c,m=he(!1),g=Ge(t=>Ae({...k.selectedTagIds,random_sort:m.value},t)),{queue:L,images:s,onContextMenuClickU:y,stackViewEl:O,previewIdx:r,previewing:x,onPreviewVisibleChange:P,previewImgMove:M,canPreview:A,itemSize:T,gridItems:K,showGenInfo:f,imageGenInfo:V,q:W,multiSelectedIdxs:h,onFileItemClick:q,scroller:v,showMenuIdx:I,onFileDragStart:Q,onFileDragEnd:j,cellWidth:H,onScroll:w,saveAllFileAsJson:Y,props:X,saveLoadedFileAsJson:Z,changeIndchecked:ee,seedChangeChecked:te,getGenDiff:le,getGenDiffWatchDep:ne}=ze(g);C(()=>k.selectedTagIds,async()=>{var t;await g.reset(),await G(),(t=v.value)==null||t.scrollToItem(0),w()},{immediate:!0}),C(m,async()=>{var t;await g.reset(),await G(),(t=v.value)==null||t.scrollToItem(0),w()}),C(()=>k,async t=>{X.value=t},{deep:!0,immediate:!0});const se=ve(),{onClearAllSelected:ie,onSelectAll:oe,onReverseSelect:ae}=Ue(),de=()=>{s.value.length!==0&&J(s.value,0)};return(t,l)=>{const ce=Fe,re=Ce,ue=Se,pe=be,_=E,me=E,ge=ye;return u(),S("div",{class:"container",ref_key:"stackViewEl",ref:O},[n(ce,{show:!!e(h).length||e(se).keepMultiSelect,onClearAllSelected:e(ie),onSelectAll:e(oe),onReverseSelect:e(ae)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),n(ge,{size:"large",spinning:!e(L).isIdle},{default:o(()=>{var $,D,F;return[n(ue,{visible:e(f),"onUpdate:visible":l[1]||(l[1]=i=>z(f)?f.value=i:null),width:"70vw","mask-closable":"",onOk:l[2]||(l[2]=i=>f.value=!1)},{cancelText:o(()=>[]),default:o(()=>[n(re,{active:"",loading:!e(W).isIdle},{default:o(()=>[d("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:l[0]||(l[0]=i=>e(Ie)(e(V)))},[d("div",Ee,a(t.$t("doubleClickToCopy")),1),p(" "+a(e(V)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),d("div",Je,[n(pe,{checked:m.value,"onUpdate:checked":l[3]||(l[3]=i=>m.value=i),"checked-children":t.$t("randomSort"),"un-checked-children":t.$t("sortByDate")},null,8,["checked","checked-children","un-checked-children"]),n(_,{onClick:de,disabled:!(($=e(s))!=null&&$.length)},{default:o(()=>[p(a(t.$t("tiktokView")),1)]),_:1},8,["disabled"]),n(_,{onClick:e(Z)},{default:o(()=>[p(a(t.$t("saveLoadedImageAsJson")),1)]),_:1},8,["onClick"]),n(_,{onClick:e(Y)},{default:o(()=>[p(a(t.$t("saveAllAsJson")),1)]),_:1},8,["onClick"])]),(D=e(s))!=null&&D.length?(u(),U(e(Be),{key:0,ref_key:"scroller",ref:v,class:"file-list",items:e(s),"item-size":e(T).first,"key-field":"fullpath","item-secondary-size":e(T).second,gridItems:e(K),onScroll:e(w)},{after:o(()=>[Le]),default:o(({item:i,index:B})=>[n(Re,{idx:B,file:i,"cell-width":e(H),"show-menu-idx":e(I),"onUpdate:showMenuIdx":l[4]||(l[4]=R=>z(I)?I.value=R:null),onDragstart:e(Q),onDragend:e(j),onFileItemClick:e(q),onTiktokView:(R,fe)=>e(J)(e(s),fe),"full-screen-preview-image-url":e(s)[e(r)]?e(we)(e(s)[e(r)]):"",selected:e(h).includes(B),onContextMenuClick:e(y),onPreviewVisibleChange:e(P),"is-selected-mutil-files":e(h).length>1,"enable-change-indicator":e(ee),"seed-change-checked":e(te),"get-gen-diff":e(le),"get-gen-diff-watch-dep":e(ne)},null,8,["idx","file","cell-width","show-menu-idx","onDragstart","onDragend","onFileItemClick","onTiktokView","full-screen-preview-image-url","selected","onContextMenuClick","onPreviewVisibleChange","is-selected-mutil-files","enable-change-indicator","seed-change-checked","get-gen-diff","get-gen-diff-watch-dep"])]),_:1},8,["items","item-size","item-secondary-size","gridItems","onScroll"])):e(g).load&&t.selectedTagIds.and_tags.length===1&&!((F=t.selectedTagIds.folder_paths_str)!=null&&F.trim())?(u(),S("div",Oe,[d("div",Pe,[d("p",Ke,a(t.$t("tagSearchNoResultsMessage")),1),n(me,{onClick:l[5]||(l[5]=i=>e(_e)()),type:"primary"},{default:o(()=>[p(a(t.$t("rebuildImageIndex")),1)]),_:1})])])):b("",!0),e(x)?(u(),S("div",We,[n(e(Ve),{onClick:l[6]||(l[6]=i=>e(M)("prev")),class:N({disable:!e(A)("prev")})},null,8,["class"]),n(e($e),{onClick:l[7]||(l[7]=i=>e(M)("next")),class:N({disable:!e(A)("next")})},null,8,["class"])])):b("",!0)]}),_:1},8,["spinning"]),e(x)&&e(s)&&e(s)[e(r)]?(u(),U(De,{key:0,file:e(s)[e(r)],idx:e(r),onContextMenuClick:e(y)},null,8,["file","idx","onContextMenuClick"])):b("",!0)],512)}}});const nt=Te(qe,[["__scopeId","data-v-6e837a6f"]]);export{nt as default};
