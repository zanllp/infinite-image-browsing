import{d as Z,p as ee,r as R,az as te,aA as le,ak as se,c7 as ie,o as v,j as A,c as s,y as e,k as g,x as a,l as k,t as u,z as F,C as oe,B as ne,O as ae,Q as N,m as $,v as re,R as w,T as ce,c8 as de,$ as ue,Y as me,V as fe,n as pe}from"./index-840caa07.js";import{F as ve,s as ge}from"./FileItem-f1712134.js";import{u as ke,g as we,c as he,b as Ce,d as Se,e as _e,o as z}from"./index-e670b2ef.js";import{M as Ie,L as ye,R as xe,f as be}from"./MultiSelectKeep-002ccaa9.js";import"./index-77c608f4.js";import"./shortcut-38b7c0ce.js";import"./_isIterateeCall-70a3012d.js";/* empty css              */const Ve={class:"refresh-button"},Me={class:"hint"},Te={key:0,class:"preview-switch"},Re=Z({__name:"randomImage",props:{tabIdx:{},paneIdx:{},id:{},paneKey:{}},setup(Ae){const B=ee(),m=R(!1),l=R([]),r=l,h=te(`${le}randomImageSettingNotificationShown`,!1),P=()=>{h.value||(w.info({content:ce("randomImageSettingNotification"),duration:6,key:"randomImageSetting"}),h.value=!0)},f=async()=>{try{m.value=!0;const i=await de();i.length===0&&w.warn("No data, please generate index in image search page first"),l.value=i}finally{m.value=!1,_()}},C=()=>{if(l.value.length===0){w.warn("没有图片可以浏览");return}z(l.value,n.value||0)};se(()=>{f(),setTimeout(()=>{P()},2e3)});const{stackViewEl:O,multiSelectedIdxs:p,stack:D,scroller:E}=ke({images:l}).toRefs(),{onClearAllSelected:G,onSelectAll:K,onReverseSelect:L}=we();he();const{itemSize:S,gridItems:U,cellWidth:Q,onScroll:_}=Ce(),{showGenInfo:c,imageGenInfo:I,q:W,onContextMenuClick:j,onFileItemClick:q}=Se({openNext:ie}),{previewIdx:n,previewing:y,onPreviewVisibleChange:H,previewImgMove:x,canPreview:b}=_e(),V=async(i,t,d)=>{D.value=[{curr:"",files:l.value}],await j(i,t,d)};return(i,t)=>{var M;const d=ue,Y=me,J=fe;return v(),A("div",{class:"container",ref_key:"stackViewEl",ref:O},[s(Ie,{show:!!e(p).length||e(B).keepMultiSelect,onClearAllSelected:e(G),onSelectAll:e(K),onReverseSelect:e(L)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),g("div",Ve,[s(d,{onClick:f,onTouchstart:F(f,["prevent"]),type:"primary",loading:m.value,shape:"round"},{default:a(()=>[k(u(i.$t("shuffle")),1)]),_:1},8,["onTouchstart","loading"]),s(d,{onClick:C,onTouchstart:F(C,["prevent"]),type:"default",disabled:!((M=l.value)!=null&&M.length),shape:"round"},{default:a(()=>[k(u(i.$t("tiktokView")),1)]),_:1},8,["onTouchstart","disabled"])]),s(J,{visible:e(c),"onUpdate:visible":t[1]||(t[1]=o=>ne(c)?c.value=o:null),width:"70vw","mask-closable":"",onOk:t[2]||(t[2]=o=>c.value=!1)},{cancelText:a(()=>[]),default:a(()=>[s(Y,{active:"",loading:!e(W).isIdle},{default:a(()=>[g("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:t[0]||(t[0]=o=>e(oe)(e(I)))},[g("div",Me,u(i.$t("doubleClickToCopy")),1),k(" "+u(e(I)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),s(e(ge),{ref_key:"scroller",ref:E,class:"file-list",items:l.value.slice(),"item-size":e(S).first,"key-field":"fullpath","item-secondary-size":e(S).second,gridItems:e(U),onScroll:e(_)},{default:a(({item:o,index:T})=>[s(ve,{idx:T,file:o,"cell-width":e(Q),"full-screen-preview-image-url":e(r)[e(n)]?e(ae)(e(r)[e(n)]):"",onContextMenuClick:V,onPreviewVisibleChange:e(H),"is-selected-mutil-files":e(p).length>1,selected:e(p).includes(T),onFileItemClick:e(q),onTiktokView:(Fe,X)=>e(z)(l.value,X)},null,8,["idx","file","cell-width","full-screen-preview-image-url","onPreviewVisibleChange","is-selected-mutil-files","selected","onFileItemClick","onTiktokView"])]),_:1},8,["items","item-size","item-secondary-size","gridItems","onScroll"]),e(y)?(v(),A("div",Te,[s(e(ye),{onClick:t[3]||(t[3]=o=>e(x)("prev")),class:N({disable:!e(b)("prev")})},null,8,["class"]),s(e(xe),{onClick:t[4]||(t[4]=o=>e(x)("next")),class:N({disable:!e(b)("next")})},null,8,["class"])])):$("",!0),e(y)&&e(r)&&e(r)[e(n)]?(v(),re(be,{key:1,file:e(r)[e(n)],idx:e(n),onContextMenuClick:V},null,8,["file","idx"])):$("",!0)],512)}}});const Ge=pe(Re,[["__scopeId","data-v-e1531e89"]]);export{Ge as default};
