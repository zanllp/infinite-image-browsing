import{d as pe,aL as ue,aM as fe,s as ge,x as me,p as he,o as m,j as S,c as n,E as e,C as a,H as L,k as d,I as ke,t as c,l as v,B as U,U as ve,V as J,m as N,a1 as we,Z as _e,a3 as Ce,a8 as Ie,aw as Se,ax as xe,n as be}from"./index-32743103.js";import{L as ye,R as Me,f as Ae,M as Ve}from"./MultiSelectKeep-56b94e1f.js";import{s as Fe,F as De}from"./FileItem-aa47825a.js";import{u as ze}from"./hook-e2eaf999.js";import{g as Ge,o as P}from"./index-c80754a2.js";/* empty css              */import"./index-e1a70e12.js";import"./shortcut-3129f75b.js";import"./_isIterateeCall-16c5cf9c.js";const x=r=>(Se("data-v-aea581a5"),r=r(),xe(),r),Te={class:"hint"},$e={class:"action-bar"},Be={class:"title line-clamp-1"},Re=x(()=>d("div",{"flex-placeholder":""},null,-1)),Ee=x(()=>d("div",{style:{padding:"16px 0 512px"}},null,-1)),Le={key:1,class:"no-res-hint"},Ue=x(()=>d("p",{class:"hint"},"æš‚æ— ç»“æžœ",-1)),Je=[Ue],Ne={key:2,class:"preview-switch"},Pe=pe({__name:"MatchedImageGrid",props:{tabIdx:{},paneIdx:{},id:{},title:{},paths:{}},setup(r){const h=r,t=ue({res:[],load:!1,loading:!1,async next(){var s;if(!(t.loading||t.load)){t.loading=!0;try{const u=t.res.length,f=(h.paths??[]).slice(u,u+200);if(!f.length){t.load=!0;return}const C=await fe(f),g=f.map(I=>C[I]).filter(Boolean);t.res.push(...g),u+200>=(((s=h.paths)==null?void 0:s.length)??0)&&(t.load=!0)}finally{t.loading=!1}}},async reset(){t.res=[],t.load=!1,await t.next()}}),{queue:K,images:l,onContextMenuClickU:b,stackViewEl:O,previewIdx:p,previewing:y,onPreviewVisibleChange:W,previewImgMove:M,canPreview:A,itemSize:V,gridItems:q,showGenInfo:k,imageGenInfo:F,q:j,multiSelectedIdxs:w,onFileItemClick:H,scroller:D,showMenuIdx:_,onFileDragStart:Q,onFileDragEnd:Z,cellWidth:X,onScroll:z,saveAllFileAsJson:Y,saveLoadedFileAsJson:ee,changeIndchecked:te,seedChangeChecked:le,getGenDiff:ie,getGenDiffWatchDep:se}=ze(t);ge(()=>h.paths,async()=>{var s;await t.reset({refetch:!0}),await me(),(s=D.value)==null||s.scrollToItem(0),z()},{immediate:!0});const ne=he(),{onClearAllSelected:ae,onSelectAll:oe,onReverseSelect:de}=Ge(),ce=()=>{l.value.length!==0&&P(l.value,0)};return(s,i)=>{const u=Ve,f=we,C=_e,g=Ce,I=Ie;return m(),S("div",{class:"container",ref_key:"stackViewEl",ref:O},[n(u,{show:!!e(w).length||e(ne).keepMultiSelect,onClearAllSelected:e(ae),onSelectAll:e(oe),onReverseSelect:e(de)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),n(I,{size:"large",spinning:!e(K).isIdle||t.loading},{default:a(()=>{var G,T,$,B;return[n(C,{visible:e(k),"onUpdate:visible":i[1]||(i[1]=o=>L(k)?k.value=o:null),width:"70vw","mask-closable":"",onOk:i[2]||(i[2]=o=>k.value=!1)},{cancelText:a(()=>[]),default:a(()=>[n(f,{active:"",loading:!e(j).isIdle},{default:a(()=>[d("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:i[0]||(i[0]=o=>e(ke)(e(F)))},[d("div",Te,c(s.$t("doubleClickToCopy")),1),v(" "+c(e(F)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),d("div",$e,[d("div",Be,"ðŸ§© "+c(h.title),1),Re,n(g,{onClick:ce,disabled:!((G=e(l))!=null&&G.length)},{default:a(()=>[v(c(s.$t("tiktokView")),1)]),_:1},8,["disabled"]),n(g,{onClick:e(ee),disabled:!((T=e(l))!=null&&T.length)},{default:a(()=>[v(c(s.$t("saveLoadedImageAsJson")),1)]),_:1},8,["onClick","disabled"]),n(g,{onClick:e(Y),disabled:!(($=e(l))!=null&&$.length)},{default:a(()=>[v(c(s.$t("saveAllAsJson")),1)]),_:1},8,["onClick","disabled"])]),(B=e(l))!=null&&B.length?(m(),U(e(Fe),{key:0,ref_key:"scroller",ref:D,class:"file-list",items:e(l),"item-size":e(V).first,"key-field":"fullpath","item-secondary-size":e(V).second,gridItems:e(q),onScroll:e(z)},{after:a(()=>[Ee]),default:a(({item:o,index:R})=>[n(De,{idx:R,file:o,"cell-width":e(X),"show-menu-idx":e(_),"onUpdate:showMenuIdx":i[3]||(i[3]=E=>L(_)?_.value=E:null),onDragstart:e(Q),onDragend:e(Z),onFileItemClick:e(H),onTiktokView:(E,re)=>e(P)(e(l),re),"full-screen-preview-image-url":e(l)[e(p)]?e(ve)(e(l)[e(p)]):"",selected:e(w).includes(R),onContextMenuClick:e(b),onPreviewVisibleChange:e(W),"is-selected-mutil-files":e(w).length>1,"enable-change-indicator":e(te),"seed-change-checked":e(le),"get-gen-diff":e(ie),"get-gen-diff-watch-dep":e(se)},null,8,["idx","file","cell-width","show-menu-idx","onDragstart","onDragend","onFileItemClick","onTiktokView","full-screen-preview-image-url","selected","onContextMenuClick","onPreviewVisibleChange","is-selected-mutil-files","enable-change-indicator","seed-change-checked","get-gen-diff","get-gen-diff-watch-dep"])]),_:1},8,["items","item-size","item-secondary-size","gridItems","onScroll"])):(m(),S("div",Le,Je)),e(y)?(m(),S("div",Ne,[n(e(ye),{onClick:i[4]||(i[4]=o=>e(M)("prev")),class:J({disable:!e(A)("prev")})},null,8,["class"]),n(e(Me),{onClick:i[5]||(i[5]=o=>e(M)("next")),class:J({disable:!e(A)("next")})},null,8,["class"])])):N("",!0)]}),_:1},8,["spinning"]),e(y)&&e(l)&&e(l)[e(p)]?(m(),U(Ae,{key:0,file:e(l)[e(p)],idx:e(p),onContextMenuClick:e(b)},null,8,["file","idx","onContextMenuClick"])):N("",!0)],512)}}});const Ye=be(Pe,[["__scopeId","data-v-aea581a5"]]);export{Ye as default};
