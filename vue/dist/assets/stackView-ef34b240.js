import{d as X,u as Ce,g as Q,_ as Ve,c as r,a as ve,P as ae,D as me,f as je,w as St,b as $t,e as It,h as Be,M as ge,i as At,A as Ft,o as g,j as x,k as l,l as V,t as p,F as ke,m as T,n as Ue,p as Pt,q as xt,r as Rt,s as De,v as O,x as i,y as e,z as d,B as N,C as Mt,E as Bt,G as Oe,H as Dt,I as Ot,J as Nt,S as Tt,K as Lt,L as Et,N as zt,O as Vt,Q as Ne,R as F,T as $,U as Te,V as fe,W as z,X as jt,Y as Ut,Z as Wt,$ as Gt,a0 as qt,a1 as Ht,a2 as Kt,a3 as Qt,a4 as Jt}from"./index-0cf80cdf.js";import{_ as Xt}from"./shortcut-76a3e0c5.js";import{D as We}from"./index-5acf9bcb.js";/* empty css              *//* empty css              */import{u as Yt,a as Zt,b as en,c as tn,d as nn,e as on,f as an,g as rn,h as ln,s as sn,o as Le}from"./index-70bdf486.js";import{s as dn,F as un}from"./FileItem-1c8f6c40.js";import{M as cn,L as pn,R as fn,f as vn}from"./MultiSelectKeep-9dd111ee.js";import"./_isIterateeCall-6a3838fa.js";var mn=["class","style"],gn=function(){return{prefixCls:String,href:String,separator:ae.any,overlay:ae.any,onClick:Function}};const J=X({compatConfig:{MODE:3},name:"ABreadcrumbItem",inheritAttrs:!1,__ANT_BREADCRUMB_ITEM:!0,props:gn(),slots:["separator","overlay"],setup:function(o,u){var f=u.slots,v=u.attrs,w=Ce("breadcrumb",o),C=w.prefixCls,P=function(I,m){var c=Q(f,o,"overlay");return c?r(We,{overlay:c,placement:"bottom"},{default:function(){return[r("span",{class:"".concat(m,"-overlay-link")},[I,r(me,null,null)])]}}):I};return function(){var h,I=(h=Q(f,o,"separator"))!==null&&h!==void 0?h:"/",m=Q(f,o),c=v.class,b=v.style,k=Ve(v,mn),y;return o.href!==void 0?y=r("a",ve({class:"".concat(C.value,"-link"),onClick:o.onClick},k),[m]):y=r("span",ve({class:"".concat(C.value,"-link"),onClick:o.onClick},k),[m]),y=P(y,C.value),m?r("span",{class:c,style:b},[y,I&&r("span",{class:"".concat(C.value,"-separator")},[I])]):null}}});var kn=function(){return{prefixCls:String,routes:{type:Array},params:ae.any,separator:ae.any,itemRender:{type:Function}}};function yn(s,o){if(!s.breadcrumbName)return null;var u=Object.keys(o).join("|"),f=s.breadcrumbName.replace(new RegExp(":(".concat(u,")"),"g"),function(v,w){return o[w]||v});return f}function Ee(s){var o=s.route,u=s.params,f=s.routes,v=s.paths,w=f.indexOf(o)===f.length-1,C=yn(o,u);return w?r("span",null,[C]):r("a",{href:"#/".concat(v.join("/"))},[C])}const W=X({compatConfig:{MODE:3},name:"ABreadcrumb",props:kn(),slots:["separator","itemRender"],setup:function(o,u){var f=u.slots,v=Ce("breadcrumb",o),w=v.prefixCls,C=v.direction,P=function(c,b){return c=(c||"").replace(/^\//,""),Object.keys(b).forEach(function(k){c=c.replace(":".concat(k),b[k])}),c},h=function(c,b,k){var y=At(c),A=P(b||"",k);return A&&y.push(A),y},I=function(c){var b=c.routes,k=b===void 0?[]:b,y=c.params,A=y===void 0?{}:y,L=c.separator,R=c.itemRender,M=R===void 0?Ee:R,E=[];return k.map(function(_){var B=P(_.path,A);B&&E.push(B);var G=[].concat(E),q=null;return _.children&&_.children.length&&(q=r(ge,null,{default:function(){return[_.children.map(function(j){return r(ge.Item,{key:j.path||j.breadcrumbName},{default:function(){return[M({route:j,params:A,routes:k,paths:h(G,j.path,A)})]}})})]}})),r(J,{overlay:q,separator:L,key:B||_.breadcrumbName},{default:function(){return[M({route:_,params:A,routes:k,paths:G})]}})})};return function(){var m,c,b,k=o.routes,y=o.params,A=y===void 0?{}:y,L=je(Q(f,o)),R=(m=Q(f,o,"separator"))!==null&&m!==void 0?m:"/",M=o.itemRender||f.itemRender||Ee;k&&k.length>0?b=I({routes:k,params:A,separator:R,itemRender:M}):L.length&&(b=L.map(function(_,B){return St($t(_.type)==="object"&&(_.type.__ANT_BREADCRUMB_ITEM||_.type.__ANT_BREADCRUMB_SEPARATOR),"Breadcrumb","Only accepts Breadcrumb.Item and Breadcrumb.Separator as it's children"),It(_,{separator:R,key:B})}));var E=(c={},Be(c,w.value,!0),Be(c,"".concat(w.value,"-rtl"),C.value==="rtl"),c);return r("div",{class:E},[b])}}});var Cn=["separator","class"],bn=function(){return{prefixCls:String}};const ye=X({compatConfig:{MODE:3},name:"ABreadcrumbSeparator",__ANT_BREADCRUMB_SEPARATOR:!0,inheritAttrs:!1,props:bn(),setup:function(o,u){var f=u.slots,v=u.attrs,w=Ce("breadcrumb",o),C=w.prefixCls;return function(){var P;v.separator;var h=v.class,I=Ve(v,Cn),m=je((P=f.default)===null||P===void 0?void 0:P.call(f));return r("span",ve({class:["".concat(C.value,"-separator"),h]},I),[m.length>0?m:"/"])}}});W.Item=J;W.Separator=ye;W.install=function(s){return s.component(W.name,W),s.component(J.name,J),s.component(ye.name,ye),s};var _n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"};const hn=_n;function ze(s){for(var o=1;o<arguments.length;o++){var u=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(u);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(u).filter(function(v){return Object.getOwnPropertyDescriptor(u,v).enumerable}))),f.forEach(function(v){wn(s,v,u[v])})}return s}function wn(s,o,u){return o in s?Object.defineProperty(s,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):s[o]=u,s}var be=function(o,u){var f=ze({},o,u.attrs);return r(Ft,ze({},f,{icon:hn}),null)};be.displayName="ArrowLeftOutlined";be.inheritAttrs=!1;const Sn=be;const $n={class:"base-info"},In=X({__name:"BaseFileListInfo",props:{fileNum:{},selectedFileNum:{}},setup(s){return(o,u)=>(g(),x("div",$n,[l("span",null,[V(p(o.$t("items",[o.fileNum]))+" ",1),o.selectedFileNum?(g(),x(ke,{key:0},[V(", "+p(o.$t("selectedItems",[o.selectedFileNum])),1)],64)):T("",!0)])]))}});const An=Ue(In,[["__scopeId","data-v-7f9c0b15"]]),Fn={class:"hint"},Pn={class:"location-bar"},xn=["onClick"],Rn={key:3,class:"location-act"},Mn={class:"actions"},Bn=["onClick"],Dn=["title"],On=["onClick"],Nn={style:{width:"512px",background:"var(--zp-primary-background)",padding:"16px","border-radius":"4px","box-shadow":"0 0 4px var(--zp-secondary-background)",border:"1px solid var(--zp-secondary-background)"}},Tn={style:{padding:"4px"}},Ln={style:{padding:"4px"}},En={style:{padding:"4px"}},zn={key:0,style:{padding:"4px"}},Vn={style:{padding:"4px"}},jn={style:{padding:"4px"}},Un=["onClick"],Wn={key:0,class:"view"},Gn={style:{padding:"16px 0 512px"}},qn={key:0,class:"preview-switch"},Hn=X({__name:"stackView",props:{tabIdx:{},paneIdx:{},path:{},mode:{},stackKey:{}},setup(s){const o=s,u=Pt(),{scroller:f,stackViewEl:v,props:w,multiSelectedIdxs:C,spinning:P}=Yt().toRefs();f.value,v.value;const{currLocation:h,currPage:I,refresh:m,copyLocation:c,back:b,openNext:k,stack:y,quickMoveTo:A,addToSearchScanPathAndQuickMove:L,locInputValue:R,isLocationEditing:M,onLocEditEnter:E,onEditBtnClick:_,share:B,selectAll:G,onCreateFloderBtnClick:q,onWalkBtnClick:Y,showWalkButton:j,searchInCurrentDir:re,backToLastUseTo:_e,polling:Ge,onPollRefreshClick:he}=Zt(),{gridItems:qe,sortMethodConv:He,moreActionsDropdownShow:Z,sortedFiles:D,sortMethod:le,itemSize:we,loadNextDir:Ke,loadNextDirLoading:Qe,canLoadNext:Je,onScroll:Xe,cellWidth:ee,dirCoverCache:Ye}=en(),{onDrop:Se,onFileDragStart:Ze,onFileDragEnd:et,onFileDropToFolder:tt}=tn(),{onFileItemClick:nt,onContextMenuClick:$e,showGenInfo:te,imageGenInfo:Ie,q:ot}=nn({openNext:k}),{previewIdx:H,onPreviewVisibleChange:at,previewing:se,previewImgMove:Ae,canPreview:Fe,scrollToFileId:rt}=on(),Pe=xt(),{showMenuIdx:ie}=an(),{onClearAllSelected:lt,onReverseSelect:st,onSelectAll:it}=rn(),{getGenDiff:dt,changeIndchecked:K,seedChangeChecked:ne,getRawGenParams:ut,getGenDiffWatchDep:ct}=ln(),pt=async(a,t)=>{await tt(a,t)||await Se(a)},ft=()=>{D.value.length!==0&&Le(D.value,H.value||0)},de=Rt(!1),vt=async()=>{Z.value=!1,de.value=!0;let a;try{F.loading({content:$("flattenFolderScanning"),key:"flatten",duration:0}),a=await Te({folder_path:h.value,dry_run:!0})}catch(t){F.destroy("flatten"),F.error(t.message||String(t)),de.value=!1;return}if(F.destroy("flatten"),de.value=!1,a.total_files===0){F.info($("flattenFolderNoFiles"));return}if(a.conflicts.length>0){fe.error({title:$("flattenFolderConflict"),content:z("div",{},[z("p",{},`${$("flattenFolderConflictFiles")}:`),z("ul",{style:"max-height: 300px; overflow-y: auto;"},a.conflicts.map(t=>z("li",{style:"color: red;"},t)))])});return}fe.confirm({title:$("flattenFolder"),content:z("div",{},[z("p",{style:"color: red; font-weight: bold;"},$("flattenFolderWarning")),z("p",{},$("flattenFolderConfirm",{count:a.total_files}))]),okText:$("confirm"),okType:"danger",cancelText:$("cancel"),onOk:async()=>{var t;try{F.loading({content:$("flattenFolderExecuting"),key:"flatten",duration:0});const S=await Te({folder_path:h.value,dry_run:!1});F.destroy("flatten"),S.success?(F.success($("flattenFolderSuccess",{count:S.moved_files})),m()):F.error(`${$("error")}: ${(t=S.errors)==null?void 0:t.join(", ")}`)}catch(S){F.destroy("flatten"),F.error(S.message||String(S))}}})};return De(()=>o,()=>{w.value=o;const a=sn.get(o.stackKey??"");a&&(y.value=a.slice())},{immediate:!0}),De(()=>Pe.visible,(a,t)=>{if(!a&&t){const S=Pe.lastActiveId;S&&rt(S)}}),(a,t)=>{const S=jt,mt=Ut,gt=fe,kt=Wt,yt=J,Ct=W,xe=Gt,ue=qt,Re=ge,ce=We,bt=Xt,oe=Ht,Me=Kt,_t=Qt,ht=Jt;return g(),O(ht,{spinning:e(P),size:"large"},{default:i(()=>[r(cn,{show:e(u).keepMultiSelect||!!e(C).length,onClearAllSelected:e(lt),onSelectAll:e(it),onReverseSelect:e(st)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),r(S,{style:{display:"none"}}),l("div",{ref_key:"stackViewEl",ref:v,onDragover:t[32]||(t[32]=d(()=>{},["prevent"])),onDrop:t[33]||(t[33]=d(n=>e(Se)(n),["prevent"])),class:"container"},[r(gt,{visible:e(te),"onUpdate:visible":t[1]||(t[1]=n=>N(te)?te.value=n:null),width:"70vw","mask-closable":"",onOk:t[2]||(t[2]=n=>te.value=!1)},{cancelText:i(()=>[]),default:i(()=>[r(mt,{active:"",loading:!e(ot).isIdle},{default:i(()=>[l("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto","z-index":"9999"},onDblclick:t[0]||(t[0]=n=>e(Mt)(e(Ie)))},[l("div",Fn,p(a.$t("doubleClickToCopy")),1),V(" "+p(e(Ie)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),l("div",Pn,[l("div",{class:"breadcrumb",style:Bt({flex:e(M)?1:""})},[e(M)?(g(),O(kt,{key:0,style:{flex:"1"},value:e(R),"onUpdate:value":t[3]||(t[3]=n=>N(R)?R.value=n:null),onClick:t[4]||(t[4]=d(()=>{},["stop"])),onKeydown:t[5]||(t[5]=d(()=>{},["stop"])),onPressEnter:e(E),"allow-clear":""},null,8,["value","onPressEnter"])):(g(),O(Ct,{key:1,style:{flex:"1"}},{default:i(()=>[(g(!0),x(ke,null,Oe(e(y),(n,U)=>(g(),O(yt,{key:U},{default:i(()=>[l("a",{onClick:d(pe=>e(b)(U),["prevent"])},p(n.curr==="/"?a.$t("root"):n.curr.replace(/:\/$/,a.$t("drive"))),9,xn)]),_:2},1024))),128))]),_:1})),e(M)?(g(),O(xe,{key:2,size:"small",onClick:e(E),type:"primary"},{default:i(()=>[V(p(a.$t("go")),1)]),_:1},8,["onClick"])):(g(),x("div",Rn,[a.mode==="scanned-fixed"?(g(),x("a",{key:0,onClick:t[6]||(t[6]=d((...n)=>e(_e)&&e(_e)(...n),["prevent"])),style:{margin:"0 8px 16px 0"}},[r(e(Sn))])):T("",!0),l("a",{onClick:t[7]||(t[7]=d((...n)=>e(c)&&e(c)(...n),["prevent"])),class:"copy"},p(a.$t("copy")),1),l("a",{onClick:t[8]||(t[8]=d((...n)=>e(_)&&e(_)(...n),["prevent","stop"]))},p(a.$t("edit")),1)]))],4),l("div",Mn,[l("a",{class:"opt",onClick:t[9]||(t[9]=d((...n)=>e(m)&&e(m)(...n),["prevent"]))},p(a.$t("refresh")),1),l("a",{class:"opt",onClick:d(ft,["prevent"])},p(a.$t("TikTok View")),9,Bn),l("a",{class:"opt",onClick:t[10]||(t[10]=d(n=>e(Dt)(e(h)),["prevent"])),title:a.$t("smartOrganizeHint")},p(a.$t("smartOrganize")),9,Dn),r(ce,null,{overlay:i(()=>[r(Re,null,{default:i(()=>[r(ue,{key:"tag-search"},{default:i(()=>[l("a",{onClick:t[12]||(t[12]=d(n=>e(re)("tag-search"),["prevent"]))},p(a.$t("imgSearch")),1)]),_:1}),r(ue,{key:"tag-search"},{default:i(()=>[l("a",{onClick:t[13]||(t[13]=d(n=>e(re)("fuzzy-search"),["prevent"]))},p(a.$t("fuzzy-search")),1)]),_:1})]),_:1})]),default:i(()=>[l("a",{class:"opt",onClick:t[11]||(t[11]=d(()=>{},["prevent"]))},[V(p(a.$t("search"))+" ",1),r(e(me))])]),_:1}),e(j)?(g(),x("a",{key:0,class:"opt",onClick:t[14]||(t[14]=d((...n)=>e(Y)&&e(Y)(...n),["prevent"]))}," Walk ")):T("",!0),l("a",{class:"opt",onClick:t[15]||(t[15]=d((...n)=>e(G)&&e(G)(...n),["prevent","stop"]))},p(a.$t("selectAll")),1),r(ce,null,{overlay:i(()=>[r(Re,null,{default:i(()=>[(g(!0),x(ke,null,Oe(e(u).quickMovePaths,n=>(g(),O(ue,{key:n.dir},{default:i(()=>[l("a",{onClick:d(U=>e(A)(n.dir),["prevent"])},p(n.zh),9,On)]),_:2},1024))),128))]),_:1})]),default:i(()=>[l("a",{class:"opt",onClick:t[16]||(t[16]=d(()=>{},["prevent"]))},[V(p(a.$t("quickMove"))+" ",1),r(e(me))])]),_:1}),r(ce,{trigger:["click"],visible:e(Z),"onUpdate:visible":t[28]||(t[28]=n=>N(Z)?Z.value=n:null),placement:"bottomLeft",getPopupContainer:n=>n.parentNode},{overlay:i(()=>[l("div",Nn,[r(_t,Ot(Nt({labelCol:{span:10},wrapperCol:{span:14}})),{default:i(()=>[r(oe,{label:a.$t("gridCellWidth")},{default:i(()=>[r(bt,{modelValue:e(ee),"onUpdate:modelValue":t[18]||(t[18]=n=>N(ee)?ee.value=n:null),max:1024,min:64,step:16},null,8,["modelValue"])]),_:1},8,["label"]),r(oe,{label:a.$t("sortingMethod")},{default:i(()=>[r(e(Tt),{value:e(le),"onUpdate:value":t[19]||(t[19]=n=>N(le)?le.value=n:null),onClick:t[20]||(t[20]=d(()=>{},["stop"])),conv:e(He),options:e(Lt)},null,8,["value","conv","options"])]),_:1},8,["label"]),r(oe,{label:a.$t("showChangeIndicators")},{default:i(()=>[r(Me,{checked:e(K),"onUpdate:checked":t[21]||(t[21]=n=>N(K)?K.value=n:null),onClick:e(ut)},null,8,["checked","onClick"])]),_:1},8,["label"]),r(oe,{label:a.$t("seedAsChange")},{default:i(()=>[r(Me,{checked:e(ne),"onUpdate:checked":t[22]||(t[22]=n=>N(ne)?ne.value=n:null),disabled:!e(K)},null,8,["checked","disabled"])]),_:1},8,["label"]),l("div",Tn,[l("a",{onClick:t[23]||(t[23]=d((...n)=>e(L)&&e(L)(...n),["prevent"]))},p(a.$t("addToSearchScanPathAndQuickMove")),1)]),l("div",Ln,[l("a",{onClick:t[24]||(t[24]=d(n=>e(Et)(e(h)+"/"),["prevent"]))},p(a.$t("openWithLocalFileBrowser")),1)]),l("div",En,[l("a",{onClick:t[25]||(t[25]=d((...n)=>e(he)&&e(he)(...n),["prevent"]))},p(e(Ge)?a.$t("stopPollRefresh"):a.$t("pollRefresh")),1)]),e(zt)?T("",!0):(g(),x("div",zn,[l("a",{onClick:t[26]||(t[26]=d((...n)=>e(B)&&e(B)(...n),["prevent"]))},p(a.$t("share")),1)])),l("div",Vn,[l("a",{onClick:t[27]||(t[27]=d((...n)=>e(q)&&e(q)(...n),["prevent"]))},p(a.$t("createFolder")),1)]),l("div",jn,[l("a",{onClick:d(vt,["prevent"]),style:{color:"#ff4d4f"}},p(a.$t("flattenFolder")),9,Un)])]),_:1},16)])]),default:i(()=>[l("a",{class:"opt",onClick:t[17]||(t[17]=d(()=>{},["prevent"]))},p(a.$t("more")),1)]),_:1},8,["visible","getPopupContainer"])])]),e(I)?(g(),x("div",Wn,[r(e(dn),{class:"file-list",items:e(D),ref_key:"scroller",ref:f,onScroll:e(Xe),"item-size":e(we).first,"key-field":"fullpath","item-secondary-size":e(we).second,gridItems:e(qe)},{default:i(({item:n,index:U})=>[r(un,{idx:parseInt(U),file:n,"full-screen-preview-image-url":e(D)[e(H)]?e(Vt)(e(D)[e(H)]):"","show-menu-idx":e(ie),"onUpdate:showMenuIdx":t[29]||(t[29]=pe=>N(ie)?ie.value=pe:null),selected:e(C).includes(U),"cell-width":e(ee),onFileItemClick:e(nt),onDragstart:e(Ze),onDragend:e(et),onPreviewVisibleChange:e(at),onContextMenuClick:e($e),onDropToFolder:pt,onTiktokView:(pe,wt)=>e(Le)(e(D),wt),"is-selected-mutil-files":e(C).length>1,"enable-change-indicator":e(K),"seed-change-checked":e(ne),"get-gen-diff":e(dt),"get-gen-diff-watch-dep":e(ct),previewing:e(se),"cover-files":e(Ye).get(n.fullpath)},null,8,["idx","file","full-screen-preview-image-url","show-menu-idx","selected","cell-width","onFileItemClick","onDragstart","onDragend","onPreviewVisibleChange","onContextMenuClick","onTiktokView","is-selected-mutil-files","enable-change-indicator","seed-change-checked","get-gen-diff","get-gen-diff-watch-dep","previewing","cover-files"])]),after:i(()=>[l("div",Gn,[o.mode==="walk"?(g(),O(xe,{key:0,onClick:e(Ke),loading:e(Qe),block:"",type:"primary",disabled:!e(Je),ghost:""},{default:i(()=>[V(p(a.$t("loadNextPage")),1)]),_:1},8,["onClick","loading","disabled"])):T("",!0)])]),_:1},8,["items","onScroll","item-size","item-secondary-size","gridItems"]),e(se)?(g(),x("div",qn,[r(e(pn),{onClick:t[30]||(t[30]=n=>e(Ae)("prev")),class:Ne({disable:!e(Fe)("prev")})},null,8,["class"]),r(e(fn),{onClick:t[31]||(t[31]=n=>e(Ae)("next")),class:Ne({disable:!e(Fe)("next")})},null,8,["class"])])):T("",!0)])):T("",!0)],544),e(se)?(g(),O(vn,{key:0,file:e(D)[e(H)],idx:e(H),onContextMenuClick:e($e)},null,8,["file","idx","onContextMenuClick"])):T("",!0),r(An,{"file-num":e(D).length,"selected-file-num":e(C).length},null,8,["file-num","selected-file-num"])]),_:1},8,["spinning"])}}});const oo=Ue(Hn,[["__scopeId","data-v-188f8e07"]]);export{oo as default};
