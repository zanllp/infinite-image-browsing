import{d as pe,aJ as ue,aK as fe,s as ge,aH as me,p as he,o as m,j as I,c as n,y as e,x as o,B as E,k as d,C as ke,t as c,l as v,v as K,O as ve,Q as L,m as N,Y as we,V as _e,$ as Ce,a4 as Se,at as Ie,au as xe,n as be}from"./index-c24b5c8e.js";import{L as ye,R as Me,f as Ae,M as Ve}from"./MultiSelectKeep-ea31915e.js";import{s as Fe,F as De}from"./FileItem-c62b10f3.js";import{u as ze}from"./hook-4227849e.js";import{g as $e,o as O}from"./index-47a4d52c.js";/* empty css              */import"./index-5130babf.js";import"./shortcut-4e374057.js";import"./_isIterateeCall-19da1ec8.js";const x=r=>(Ie("data-v-795e5ef4"),r=r(),xe(),r),Ge={class:"hint"},Te={class:"action-bar"},Be={class:"title line-clamp-1"},Re=x(()=>d("div",{"flex-placeholder":""},null,-1)),Je=x(()=>d("div",{style:{padding:"16px 0 512px"}},null,-1)),Ee={key:1,class:"no-res-hint"},Ke=x(()=>d("p",{class:"hint"},"æš‚æ— ç»“æžœ",-1)),Le=[Ke],Ne={key:2,class:"preview-switch"},Oe=pe({__name:"MatchedImageGrid",props:{tabIdx:{},paneIdx:{},id:{},title:{},paths:{}},setup(r){const h=r,t=ue({res:[],load:!1,loading:!1,async next(){var s;if(!(t.loading||t.load)){t.loading=!0;try{const u=t.res.length,f=(h.paths??[]).slice(u,u+200);if(!f.length){t.load=!0;return}const C=await fe(f),g=f.map(S=>C[S]).filter(Boolean);t.res.push(...g),u+200>=(((s=h.paths)==null?void 0:s.length)??0)&&(t.load=!0)}finally{t.loading=!1}}},async reset(){t.res=[],t.load=!1,await t.next()}}),{queue:P,images:l,onContextMenuClickU:b,stackViewEl:U,previewIdx:p,previewing:y,onPreviewVisibleChange:W,previewImgMove:M,canPreview:A,itemSize:V,gridItems:q,showGenInfo:k,imageGenInfo:F,q:Q,multiSelectedIdxs:w,onFileItemClick:j,scroller:D,showMenuIdx:_,onFileDragStart:H,onFileDragEnd:Y,cellWidth:X,onScroll:z,saveAllFileAsJson:Z,saveLoadedFileAsJson:ee,changeIndchecked:te,seedChangeChecked:le,getGenDiff:ie,getGenDiffWatchDep:se}=ze(t);ge(()=>h.paths,async()=>{var s;await t.reset({refetch:!0}),await me(),(s=D.value)==null||s.scrollToItem(0),z()},{immediate:!0});const ne=he(),{onClearAllSelected:oe,onSelectAll:ae,onReverseSelect:de}=$e(),ce=()=>{l.value.length!==0&&O(l.value,0)};return(s,i)=>{const u=Ve,f=we,C=_e,g=Ce,S=Se;return m(),I("div",{class:"container",ref_key:"stackViewEl",ref:U},[n(u,{show:!!e(w).length||e(ne).keepMultiSelect,onClearAllSelected:e(oe),onSelectAll:e(ae),onReverseSelect:e(de)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),n(S,{size:"large",spinning:!e(P).isIdle||t.loading},{default:o(()=>{var $,G,T,B;return[n(C,{visible:e(k),"onUpdate:visible":i[1]||(i[1]=a=>E(k)?k.value=a:null),width:"70vw","mask-closable":"",onOk:i[2]||(i[2]=a=>k.value=!1)},{cancelText:o(()=>[]),default:o(()=>[n(f,{active:"",loading:!e(Q).isIdle},{default:o(()=>[d("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:i[0]||(i[0]=a=>e(ke)(e(F)))},[d("div",Ge,c(s.$t("doubleClickToCopy")),1),v(" "+c(e(F)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),d("div",Te,[d("div",Be,"ðŸ§© "+c(h.title),1),Re,n(g,{onClick:ce,disabled:!(($=e(l))!=null&&$.length)},{default:o(()=>[v(c(s.$t("tiktokView")),1)]),_:1},8,["disabled"]),n(g,{onClick:e(ee),disabled:!((G=e(l))!=null&&G.length)},{default:o(()=>[v(c(s.$t("saveLoadedImageAsJson")),1)]),_:1},8,["onClick","disabled"]),n(g,{onClick:e(Z),disabled:!((T=e(l))!=null&&T.length)},{default:o(()=>[v(c(s.$t("saveAllAsJson")),1)]),_:1},8,["onClick","disabled"])]),(B=e(l))!=null&&B.length?(m(),K(e(Fe),{key:0,ref_key:"scroller",ref:D,class:"file-list",items:e(l),"item-size":e(V).first,"key-field":"fullpath","item-secondary-size":e(V).second,gridItems:e(q),onScroll:e(z)},{after:o(()=>[Je]),default:o(({item:a,index:R})=>[n(De,{idx:R,file:a,"cell-width":e(X),"show-menu-idx":e(_),"onUpdate:showMenuIdx":i[3]||(i[3]=J=>E(_)?_.value=J:null),onDragstart:e(H),onDragend:e(Y),onFileItemClick:e(j),onTiktokView:(J,re)=>e(O)(e(l),re),"full-screen-preview-image-url":e(l)[e(p)]?e(ve)(e(l)[e(p)]):"",selected:e(w).includes(R),onContextMenuClick:e(b),onPreviewVisibleChange:e(W),"is-selected-mutil-files":e(w).length>1,"enable-change-indicator":e(te),"seed-change-checked":e(le),"get-gen-diff":e(ie),"get-gen-diff-watch-dep":e(se)},null,8,["idx","file","cell-width","show-menu-idx","onDragstart","onDragend","onFileItemClick","onTiktokView","full-screen-preview-image-url","selected","onContextMenuClick","onPreviewVisibleChange","is-selected-mutil-files","enable-change-indicator","seed-change-checked","get-gen-diff","get-gen-diff-watch-dep"])]),_:1},8,["items","item-size","item-secondary-size","gridItems","onScroll"])):(m(),I("div",Ee,Le)),e(y)?(m(),I("div",Ne,[n(e(ye),{onClick:i[4]||(i[4]=a=>e(M)("prev")),class:L({disable:!e(A)("prev")})},null,8,["class"]),n(e(Me),{onClick:i[5]||(i[5]=a=>e(M)("next")),class:L({disable:!e(A)("next")})},null,8,["class"])])):N("",!0)]}),_:1},8,["spinning"]),e(y)&&e(l)&&e(l)[e(p)]?(m(),K(Ae,{key:0,file:e(l)[e(p)],idx:e(p),onContextMenuClick:e(b)},null,8,["file","idx","onContextMenuClick"])):N("",!0)],512)}}});const Ze=be(Oe,[["__scopeId","data-v-795e5ef4"]]);export{Ze as default};
